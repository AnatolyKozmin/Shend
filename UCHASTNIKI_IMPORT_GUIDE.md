# üìã –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–º–ø–æ—Ä—Ç—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ uchast.xlsx

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (`uchastniki`), –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –•—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ Excel —Ñ–∞–π–ª–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤—è–∑—ã–≤–∞—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å —Ç–∞–±–ª–∏—Ü–µ–π `BotUser` –ø–æ `telegram_username`
- –î–æ–±–∞–≤–ª—è—Ç—å `tg_id` –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫ —Ç–µ–º, –∫—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ –±–æ—Ç–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã `uchastniki`

- `id` - –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
- `full_name` - –§–ò–û —É—á–∞—Å—Ç–Ω–∏–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ)
- `course` - –∫—É—Ä—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `faculty` - —Ñ–∞–∫—É–ª—å—Ç–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `telegram_username` - username –≤ Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `tg_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã BotUser (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Ä–∞—Å—Å—ã–ª–æ–∫)
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

## –®–∞–≥–∏ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Alembic –Ω–∞–ø—Ä—è–º—É—é
alembic upgrade head

# –ò–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
python migration/script.py upgrade head
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ñ–∞–π–ª uchast.xlsx

–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
- **–§–ò–û** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –ø–æ–ª–Ω–æ–µ –∏–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
- **–ö—É—Ä—Å** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫—É—Ä—Å –æ–±—É—á–µ–Ω–∏—è
- **–§–∞–∫—É–ª—å—Ç–µ—Ç** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ñ–∞–∫—É–ª—å—Ç–µ—Ç
- **telegram_username** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - username –≤ Telegram (—Å @ –∏–ª–∏ –±–µ–∑)

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
```
–§–ò–û              | –ö—É—Ä—Å | –§–∞–∫—É–ª—å—Ç–µ—Ç | telegram_username
–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω       | 2    | –§–∏–Ω—Ñ–∞–∫    | @ivanov
–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞      | 3    | –≠–∫–æ–Ω–æ–º    | petrova
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç

```bash
# –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏)
python scripts/load_uchastniki.py

# –†–µ–∂–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏)
python scripts/load_uchastniki.py --update
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. **–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - —Å–∫—Ä–∏–ø—Ç —á–∏—Ç–∞–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ `uchast.xlsx`
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ BotUser** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å `telegram_username` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –µ—Å—Ç—å –ª–∏ –æ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ `BotUser`
3. **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ** - –µ—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ –Ω–∞–π–¥–µ–Ω –≤ `BotUser`, –µ–≥–æ `tg_id` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `uchastniki`
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç:
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
- üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- ‚è≠Ô∏è –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)
- üîó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å BotUser (–∏–º–µ—é—Ç tg_id)
- ‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚úÖ –ü—Ä–æ—á–∏—Ç–∞–Ω–æ 120 —Å—Ç—Ä–æ–∫ –∏–∑ uchast.xlsx
üìä –ù–∞–π–¥–µ–Ω–æ 85 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ BotUser –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

‚úÖ –°—Ç—Ä–æ–∫–∞ 2: –¥–æ–±–∞–≤–ª–µ–Ω '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω' —Å tg_id=123456789
‚úÖ –°—Ç—Ä–æ–∫–∞ 3: –¥–æ–±–∞–≤–ª–µ–Ω '–ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞' (–±–µ–∑ tg_id)
...

==================================================
‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
==================================================
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö: 115
   üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–æ: 5
   ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 0
   üîó –°–≤—è–∑–∞–Ω–æ —Å BotUser: 85
   ‚ùå –û—à–∏–±–æ–∫: 0
   üìà –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 120
==================================================
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ:

```python
from db.engine import async_session_maker
from db.models import Uchastnik
from sqlalchemy import select

async with async_session_maker() as session:
    # –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏
    stmt = select(Uchastnik)
    result = await session.execute(stmt)
    all_uchastniki = result.scalars().all()
    print(f"–í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {len(all_uchastniki)}")
    
    # –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å tg_id (–µ—Å—Ç—å –≤ –±–æ—Ç–µ)
    stmt_with_tg = select(Uchastnik).where(Uchastnik.tg_id.isnot(None))
    result_with_tg = await session.execute(stmt_with_tg)
    with_tg = result_with_tg.scalars().all()
    print(f"–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å tg_id: {len(with_tg)}")
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç `telegram_username` (—É–±–∏—Ä–∞–µ—Ç @ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ lowercase)
- –ï—Å–ª–∏ —É —É—á–∞—Å—Ç–Ω–∏–∫–∞ –Ω–µ—Ç `telegram_username`, –æ–Ω –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω, –Ω–æ –±–µ–∑ `tg_id`
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ `telegram_username` (–µ—Å–ª–∏ –µ—Å—Ç—å) –∏–ª–∏ –ø–æ `full_name`
- –§–∞–π–ª `uchast.xlsx` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

