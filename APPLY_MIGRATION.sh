#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

echo "üöÄ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ Reserv –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ"
echo "=========================================="

# –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
echo "1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞..."
docker-compose down

# –®–∞–≥ 2: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
echo "2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏..."
docker-compose run --rm bot alembic upgrade head

# –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
echo "3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ res.xlsx? (y/n)"
read -r answer
if [ "$answer" = "y" ]; then
    echo "   –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."
    docker-compose run --rm bot python scripts/load_reserv.py
fi

# –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
echo "4. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞..."
docker-compose up -d

echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω."
echo ""
echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–º–∞–Ω–¥—ã:"
echo "  /poter - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π"
echo "  /create_reserv_rass - —Ä–∞—Å—Å—ã–ª–∫–∞ –∏–∑ Reserv"
echo "  /dodep_reserv - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞"

