# üîÑ –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–µ—Ä–∞ Google Sheets

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- –õ–∏—Å—Ç—ã —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Ç–∏–ø–∞ "29.10 / –°–ù–∏–ú–ö + –ú–≠–û"
- –†–∞–∑–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã —Å—Ç—Ä–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤
- ID —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ –≤ —Å—Ç–æ–ª–±—Ü–µ W (–∏–Ω–¥–µ–∫—Å 22)

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- –õ–∏—Å—Ç—ã —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏: **"1", "2", "3", "4", "5", "6"**
- –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –ø–∞—Ä—Å—è—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- ID —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ –≤ —Å—Ç–æ–ª–±—Ü–µ **T (–∏–Ω–¥–µ–∫—Å 19)**

---

## üìä –ú–∞–ø–ø–∏–Ω–≥ –ª–∏—Å—Ç–æ–≤ –Ω–∞ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—ã

| –õ–∏—Å—Ç | –§–∞–∫—É–ª—å—Ç–µ—Ç—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----------|----------|
| **"1"** | –ú–≠–û + –°–ù–∏–ú–ö | –û–¥–Ω–æ –∑–¥–∞–Ω–∏–µ, –æ–¥–∏–Ω –¥–µ–Ω—å |
| **"2"** | –§–≠–ë | |
| **"3"** | –Æ—Ä—Ñ–∞–∫ | |
| **"4"** | –ò–¢–∏–ê–ë–î | |
| **"5"** | –§–∏–Ω–§–∞–∫ | |
| **"6"** | –ù–ê–ë + –í–®–£ | –û–¥–Ω–æ –∑–¥–∞–Ω–∏–µ, –æ–¥–∏–Ω –¥–µ–Ω—å |

---

## üìù –§–æ—Ä–º–∞—Ç –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞

### –°—Ç–æ–ª–±—Ü—ã:
- **A**: –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ
- **B-S** (–∏–Ω–¥–µ–∫—Å—ã 1-18): –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
  - `1` = —Å–æ–±–µ—Å–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–µ–Ω
  - –ø—É—Å—Ç–æ = –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **T** (–∏–Ω–¥–µ–∫—Å 19): ID —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ (–∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã)

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã (B-S):
```
B  = 09:00
C  = 09:45
D  = 10:30
E  = 11:15
F  = 12:00
G  = 12:45
H  = 13:30  ‚Üê –û–ë–ï–î (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è!)
I  = 14:15
J  = 15:00
K  = 15:45
L  = 16:30
M  = 17:15
N  = 18:00
O  = 18:45
P  = 19:15
Q  = 20:00
R  = 20:45
S  = 21:30
```

---

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä

### 1. –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º –ª–∏—Å—Ç–∞–º ("1"-"6")
```python
for sheet_name in ["1", "2", "3", "4", "5", "6"]:
    worksheet = sheet.worksheet(sheet_name)
    faculties = SCHEDULE_SHEETS[sheet_name]['faculties']
```

### 2. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
```python
interviewer_name = row[0]  # –°—Ç–æ–ª–±–µ—Ü A
interviewer_id = row[19]   # –°—Ç–æ–ª–±–µ—Ü T

if not interviewer_name or not interviewer_id:
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
```

### 3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞:
```python
for col_idx in range(1, 19):  # B-S
    if row[col_idx] == "1":
        # –°–æ–∑–¥–∞—ë–º —Å–ª–æ—Ç –≤ –ë–î
        create_slot(interviewer_id, date, time_start, time_end, faculties)
```

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã –Ω–∞ –æ–¥–Ω–æ –≤—Ä–µ–º—è
–ï—Å–ª–∏ 4 —Å–æ–±–µ—Å–µ–¥—É—é—â–∏—Ö —Å–≤–æ–±–æ–¥–Ω—ã –≤ 9:00, —Å–æ–∑–¥–∞—ë—Ç—Å—è **4 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–ª–æ—Ç–∞** –≤ –ë–î:
```
TimeSlot(interviewer_id=1, time_start="09:00", is_available=True)
TimeSlot(interviewer_id=2, time_start="09:00", is_available=True)
TimeSlot(interviewer_id=3, time_start="09:00", is_available=True)
TimeSlot(interviewer_id=4, time_start="09:00", is_available=True)
```

–ö–æ–≥–¥–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω** –∏–∑ –Ω–∏—Ö:
```
TimeSlot(interviewer_id=2, time_start="09:00", is_available=False)  ‚Üê –ó–∞–Ω—è—Ç!
```

### 2. –î–æ–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º `/sync_slots`:
- ‚úÖ –î–æ–±–∞–≤–ª—è—é—Ç—Å—è **–Ω–æ–≤—ã–µ** —Å–ª–æ—Ç—ã
- ‚úÖ –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è **—Å–≤–æ–±–æ–¥–Ω—ã–µ** —Å–ª–æ—Ç—ã
- ‚ùå **–ù–ï —Ç—Ä–æ–≥–∞—é—Ç—Å—è** –∑–∞–Ω—è—Ç—ã–µ —Å–ª–æ—Ç—ã (`is_available=False`)
- ‚ùå **–ù–ï —É–¥–∞–ª—è—é—Ç—Å—è** —Å—Ç–∞—Ä—ã–µ —Å–ª–æ—Ç—ã

### 3. –§–∞–∫—É–ª—å—Ç–µ—Ç—ã —Å–æ–±–µ—Å–µ–¥—É—é—â–∏—Ö
–§–∞–∫—É–ª—å—Ç–µ—Ç—ã **–Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è**, –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è:
```python
# –ü–µ—Ä–≤—ã–π sync: –ª–∏—Å—Ç "1" (–ú–≠–û, –°–ù–∏–ú–ö)
interviewer.faculties = "–ú–≠–û,–°–ù–∏–ú–ö"

# –í—Ç–æ—Ä–æ–π sync: –ª–∏—Å—Ç "6" (–ù–ê–ë, –í–®–£)
interviewer.faculties = "–ú–≠–û,–ù–ê–ë,–°–ù–∏–ú–ö,–í–®–£"  # –î–æ–±–∞–≤–∏–ª–∏—Å—å!
```

---

## üìä –ö–æ–º–∞–Ω–¥–∞ /sobeser_stats

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º —Å–æ–±–µ—Å–µ–¥—É—é—â–∏–º:

```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–æ–±–µ—Å–µ–¥—É—é—â–∏–º

üë§ –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω
   ID: interviewer_001
   üéì –§–∞–∫—É–ª—å—Ç–µ—Ç—ã: –ú–≠–û,–°–ù–∏–ú–ö
   üìä –°–ª–æ—Ç–æ–≤: 12 (üü¢ 8 —Å–≤–æ–±–æ–¥–Ω–æ, üî¥ 4 –∑–∞–Ω—è—Ç–æ)

üë§ –ü–µ—Ç—Ä–æ–≤–∞ –ê–Ω–Ω–∞
   ID: interviewer_002
   üéì –§–∞–∫—É–ª—å—Ç–µ—Ç—ã: –§–≠–ë
   üìä –°–ª–æ—Ç–æ–≤: 8 (üü¢ 8 —Å–≤–æ–±–æ–¥–Ω–æ, üî¥ 0 –∑–∞–Ω—è—Ç–æ)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
–ò—Ç–æ–≥–æ:
üë• –°–æ–±–µ—Å–µ–¥—É—é—â–∏—Ö: 15
üìä –í—Å–µ–≥–æ —Å–ª–æ—Ç–æ–≤: 180
üü¢ –°–≤–æ–±–æ–¥–Ω–æ: 145
üî¥ –ó–∞–Ω—è—Ç–æ: 35
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞ –ë–î (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
echo "
DELETE FROM interview_messages;
DELETE FROM interviews;
DELETE FROM time_slots;
" | docker exec -i shend-db-1 psql -U postgres -d shabot_db
```

### –®–∞–≥ 2: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```
–í –±–æ—Ç–µ: /sync_slots
```

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
1. –ü–∞—Ä—Å—è—Ç—Å—è –≤—Å–µ –ª–∏—Å—Ç—ã "1"-"6"
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ:
   - –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ë–î –ø–æ `interviewer_sheet_id`
   - –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—ã
   - –°–æ–∑–¥–∞—é—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å–ª–æ—Ç—ã
3. –í—ã–≤–æ–¥–∏—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
```
–í –±–æ—Ç–µ: /sobeser_stats
```

---

## üéì –ü–æ–∫–∞–∑ —Å–ª–æ—Ç–æ–≤ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º

### –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ñ–∞–∫—É–ª—å—Ç–µ—Ç:
```python
# 1. –ò–∑ —Ç–∞–±–ª–∏—Ü—ã people
person = get_person(user_id)
faculty = person.faculty  # "–ú–≠–û"

# 2. –ò–ª–∏ –≤—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞
faculties = ["–ú–≠–û", "–°–ù–∏–ú–ö", "–§–≠–ë", "–Æ—Ä—Ñ–∞–∫", ...]
```

### –ö–∞–∫–∏–µ —Å–ª–æ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è:
```sql
SELECT * FROM time_slots 
JOIN interviewers ON interviewers.id = time_slots.interviewer_id
WHERE time_slots.is_available = true
AND interviewers.faculties LIKE '%–ú–≠–û%'  -- –§–∞–∫—É–ª—å—Ç–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
ORDER BY time_slots.date, time_slots.time_start
```

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:
–ï—Å–ª–∏ 4 —Å–æ–±–µ—Å–µ–¥—É—é—â–∏—Ö —Å–≤–æ–±–æ–¥–Ω—ã –≤ 9:00, –∫–∞–Ω–¥–∏–¥–∞—Ç –≤–∏–¥–∏—Ç **–æ–¥–Ω—É** –∫–Ω–æ–ø–∫—É "09:00".

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ **—Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è** –æ–¥–∏–Ω –∏–∑ 4 —Å–ª–æ—Ç–æ–≤.

---

## üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏:
```python
if not interviewer_name or not interviewer_id:
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º
```

### –°–æ–±–µ—Å–µ–¥—É—é—â–∏–π –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:
```python
if not interviewer:
    skipped += 1
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–æ—Ç
```

### –ó–∞–Ω—è—Ç—ã–π —Å–ª–æ—Ç:
```python
if existing_slot and not existing_slot.is_available:
    skipped += 1  # –ù–µ —Ç—Ä–æ–≥–∞–µ–º!
```

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `utils/google_sheets.py`
- –û–±–Ω–æ–≤–ª—ë–Ω `SCHEDULE_SHEETS` (–ª–∏—Å—Ç—ã "1"-"6")
- –ò–∑–º–µ–Ω—ë–Ω –∏–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞ ID: 22 ‚Üí 19 (W ‚Üí T)
- –£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (–Ω–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫)

### 2. `handlers/interview_handlers.py`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/sobeser_stats`
- `/sync_slots` —É–∂–µ —Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–µ —É–¥–∞–ª—è–µ—Ç, –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç –∑–∞–Ω—è—Ç—ã–µ)

### 3. `NEW_PARSER_STRUCTURE.md`
- –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –î–µ–ø–ª–æ–π

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
git add utils/google_sheets.py handlers/interview_handlers.py NEW_PARSER_STRUCTURE.md
git commit -m "feat: –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–µ—Ä–∞ (–ª–∏—Å—Ç—ã 1-6, —Å—Ç–æ–ª–±–µ—Ü T), –∫–æ–º–∞–Ω–¥–∞ /sobeser_stats"
git push origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@sha
cd ~/Shend
git pull origin main
docker-compose restart bot

# –û—á–∏—Å—Ç–∏—Ç—å –ë–î
echo "DELETE FROM interview_messages; DELETE FROM interviews; DELETE FROM time_slots;" | docker exec -i shend-db-1 psql -U postgres -d shabot_db

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å
–í –±–æ—Ç–µ: /sync_slots

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
–í –±–æ—Ç–µ: /sobeser_stats
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. **–ü—Ä–æ—â–µ** - –ª–∏—Å—Ç—ã "1"-"6" –≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π
2. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ** - –≤—Å–µ –ª–∏—Å—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
3. **–ù–∞–¥—ë–∂–Ω–µ–µ** - –Ω–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —Å—Ç—Ä–æ–∫ (–ø–∞—Ä—Å–∏–º –≤—Å–µ)
4. **–ì–∏–±—á–µ** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Å–æ–±–µ—Å–µ–¥—É—é—â–∏—Ö –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏
5. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–∏—Å—Ç "7", "8" –∏ —Ç.–¥.

---

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üéØüöÄ

