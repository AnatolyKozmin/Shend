# üìä –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ Google Sheets

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–º–∞–Ω–¥–∞ `/export_interviews` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è –≤ Google Sheets –Ω–∞ –ª–∏—Å—Ç **WORK**.

---

## üìã –§–æ—Ä–º–∞—Ç –ª–∏—Å—Ç–∞ WORK

### –°—Ç–æ–ª–±—Ü—ã:
| –°—Ç–æ–ª–±–µ—Ü | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| A | –ö–∞–Ω–¥–∏–¥–∞—Ç | –§–ò–û –∏–ª–∏ @username |
| B | –§–∞–∫—É–ª—å—Ç–µ—Ç | –ú–≠–û, –°–ù–∏–ú–ö, –§–≠–ë –∏ —Ç.–¥. |
| C | –î–∞—Ç–∞ | 2024-10-29 |
| D | –í—Ä–µ–º—è | 09:00-09:45 |
| E | –°–æ–±–µ—Å–µ–¥—É—é—â–∏–π | –§–ò–û —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ |
| F | ID —Å–æ–±–µ—Å–µ–¥—É—é—â–µ–≥–æ | interviewer_001 |
| G | –°—Ç–∞—Ç—É—Å | confirmed/pending |
| H | –î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏ | 2024-10-28 15:30 |

### –ü—Ä–∏–º–µ—Ä:
```
| –ö–∞–Ω–¥–∏–¥–∞—Ç          | –§–∞–∫—É–ª—å—Ç–µ—Ç | –î–∞—Ç–∞       | –í—Ä–µ–º—è       | –°–æ–±–µ—Å–µ–¥—É—é—â–∏–π  | ID            | –°—Ç–∞—Ç—É—Å    | –î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏      |
|-------------------|-----------|------------|-------------|---------------|---------------|-----------|------------------|
| –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω       | –ú–≠–û       | 2024-10-29 | 09:00-09:45 | –ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä   | interviewer_1 | confirmed | 2024-10-28 15:30 |
| @anna_petrova     | –°–ù–∏–ú–ö     | 2024-10-29 | 10:30-11:15 | –°–∏–¥–æ—Ä–æ–≤ –ò–≤–∞–Ω  | interviewer_2 | confirmed | 2024-10-28 16:15 |
| –í–∞—Å–∏–ª—å–µ–≤ –í–∞—Å–∏–ª–∏–π  | –§–≠–ë       | 2024-10-30 | 14:15-15:00 | –ò–≤–∞–Ω–æ–≤–∞ –ê–Ω–Ω–∞  | interviewer_3 | confirmed | 2024-10-28 17:00 |
```

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ö–æ–º–∞–Ω–¥–∞:
```
/export_interviews
```

### –î–æ—Å—Ç—É–ø:
- ‚õî –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (tg_id: 922109605)

### –ü—Ä–æ—Ü–µ—Å—Å:
1. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ë–î
2. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:
   - –ö–∞–Ω–¥–∏–¥–∞—Ç (–∏–∑ `people` –∏–ª–∏ `bot_users`)
   - –°–ª–æ—Ç (–¥–∞—Ç–∞, –≤—Ä–µ–º—è)
   - –°–æ–±–µ—Å–µ–¥—É—é—â–∏–π
   - –°—Ç–∞—Ç—É—Å
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Google Sheets:
   - –ï—Å–ª–∏ –ª–∏—Å—Ç WORK —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –æ—á–∏—â–∞–µ—Ç –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç
   - –ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –ª–∏—Å—Ç
4. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç, —Å–µ—Ä—ã–π —Ñ–æ–Ω)

---

## üìä –ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

### –í–∫–ª—é—á–∞—é—Ç—Å—è:
- ‚úÖ –ó–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `confirmed`
- ‚úÖ –ó–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`

### –ù–ï –≤–∫–ª—é—á–∞—é—Ç—Å—è:
- ‚ùå –û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`cancelled`)

---

## üé® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–≥–æ–ª–æ–≤–æ–∫:
- **–ñ–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç**
- –°–µ—Ä—ã–π —Ñ–æ–Ω (RGB: 0.9, 0.9, 0.9)

### –î–∞–Ω–Ω—ã–µ:
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- –§–ò–û –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –∏–ª–∏ @username –µ—Å–ª–∏ –§–ò–û –Ω–µ—Ç
- –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- –í—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM-HH:MM
- –î–∞—Ç–∞ –∑–∞–ø–∏—Å–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD HH:MM

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞:
```python
def export_interviews_to_sheet(interviews_data: List[Dict]) -> bool:
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ –ª–∏—Å—Ç WORK.
    
    Args:
        interviews_data: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–ø–∏—Å–µ–π
    
    Returns:
        True –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, False –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
    """
```

### –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–∞:
```python
try:
    worksheet = sheet.worksheet('WORK')
    worksheet.clear()  # –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
except:
    worksheet = sheet.add_worksheet(title='WORK', rows=1000, cols=10)  # –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π
```

### –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö:
```python
rows = [headers]  # –ó–∞–≥–æ–ª–æ–≤–∫–∏
for interview in interviews_data:
    rows.append([...])  # –î–∞–Ω–Ω—ã–µ

worksheet.update('A1', rows)  # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤—Å—ë –∑–∞ —Ä–∞–∑
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç
```
–ê–¥–º–∏–Ω: /export_interviews

–ë–æ—Ç:
üîÑ –ù–∞—á–∏–Ω–∞—é —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ Google Sheets...

‚úÖ –£—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 25 –∑–∞–ø–∏—Å–µ–π –≤ –ª–∏—Å—Ç WORK!

üìä –¢–∞–±–ª–∏—Ü–∞: https://docs.google.com/spreadsheets/d/...
üìã –õ–∏—Å—Ç: WORK
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π
```
–ê–¥–º–∏–Ω: /export_interviews

–ë–æ—Ç:
üîÑ –ù–∞—á–∏–Ω–∞—é —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ Google Sheets...

üìã –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—à–∏–±–∫–∞
```
–ê–¥–º–∏–Ω: /export_interviews

–ë–æ—Ç:
üîÑ –ù–∞—á–∏–Ω–∞—é —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ Google Sheets...

‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ Google Sheets.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –í Google Sheets:
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
2. –ù–∞–π—Ç–∏ –ª–∏—Å—Ç **WORK**
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ:
   - –ó–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞ –º–µ—Å—Ç–µ (–∂–∏—Ä–Ω—ã–µ, —Å–µ—Ä—ã–π —Ñ–æ–Ω)
   - –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π + 1 (–∑–∞–≥–æ–ª–æ–≤–æ–∫)

### –í –ª–æ–≥–∞—Ö –±–æ—Ç–∞:
```bash
docker logs shend-bot-1 --tail 50

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
üìã –õ–∏—Å—Ç WORK –Ω–∞–π–¥–µ–Ω, –æ—á–∏—â–∞—é...
‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 25 –∑–∞–ø–∏—Å–µ–π –≤ –ª–∏—Å—Ç WORK
```

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```
‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Google Sheets: 403 Forbidden
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ.

### –û—à–∏–±–∫–∞ 2: –¢–∞–±–ª–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
```
‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Google Sheets: Spreadsheet not found
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `SCHEDULE_SHEET_ID` –≤ `utils/google_sheets.py`.

### –û—à–∏–±–∫–∞ 3: Rate limit
```
‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Google Sheets: Quota exceeded
```

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞.

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏:

```python
# –í sobes_confirm_callback –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏:
await session.commit()

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º
asyncio.create_task(auto_export_interviews())
```

–ù–æ **–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –∏–∑-–∑–∞:
- Rate limits Google API
- –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
- –õ–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã

–õ—É—á—à–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å **–≤—Ä—É—á–Ω—É—é** –ø–æ –∫–æ–º–∞–Ω–¥–µ –∏–ª–∏ **–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ —á–∞—Å).

---

## üìä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### Excel/CSV:
–ú–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –ª–∏—Å—Ç WORK –∫–∞–∫ CSV:
```
File ‚Üí Download ‚Üí Comma Separated Values (.csv)
```

### Power BI / Tableau:
–ú–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Google Sheets –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä.

### Python —Å–∫—Ä–∏–ø—Ç:
```python
import gspread
from google.oauth2.service_account import Credentials

# –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ
gc = gspread.authorize(creds)
sheet = gc.open_by_key(SHEET_ID)
worksheet = sheet.worksheet('WORK')
data = worksheet.get_all_records()

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º
import pandas as pd
df = pd.DataFrame(data)
print(df.groupby('–§–∞–∫—É–ª—å—Ç–µ—Ç').size())
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–£–¥–æ–±–Ω–æ** - –≤—Å–µ –∑–∞–ø–∏—Å–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
2. **–ù–∞–≥–ª—è–¥–Ω–æ** - –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å
3. **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ** - –ª–µ–≥–∫–æ —Å–∫–∞—á–∞—Ç—å –≤ Excel
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º–æ** - –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ BI —Å–∏—Å—Ç–µ–º–∞–º
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** - –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —É –∞–¥–º–∏–Ω–∞

---

## üöÄ –î–µ–ø–ª–æ–π

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
git add utils/google_sheets.py handlers/interview_handlers.py EXPORT_TO_SHEETS.md
git commit -m "feat: —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ Google Sheets (–ª–∏—Å—Ç WORK)"
git push origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@sha
cd ~/Shend
git pull origin main
docker-compose restart bot

# –¢–µ—Å—Ç
–í –±–æ—Ç–µ: /export_interviews
```

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üìäüöÄ

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π!

